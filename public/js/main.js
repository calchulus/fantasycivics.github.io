!function t(e,n,a){function r(i,s){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[i]={exports:{}};e[i][0].call(d.exports,function(t){var n=e[i][1][t];return r(n||t)},d,d.exports,t,e,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(t,e,n){"use strict";var a=t("./views"),r=t("./scoring"),o={apiKey:"AIzaSyDusGUpsFfhJmRnmB2cgfetwR3ZR2otqe4",authDomain:"fantasycivics.firebaseapp.com",databaseURL:"https://fantasycivics.firebaseio.com",storageBucket:"fantasycivics.appspot.com",messagingSenderId:"245596715039"},i=firebase.initializeApp(o,"Fantasy Civics Game").database(),s=(0,a.Views)(),l=(0,r.Scoring)(),c=new Date("8/1/2017"),d=c.getUTCMonth()-1,u=[new Date(c.getUTCFullYear(),d).getTime(),new Date(c.getUTCFullYear(),c.getUTCMonth()).getTime()];console.log(u),i.ref("player_scores").orderByChild("timestamp").startAt(u[0]).endAt(u[1]).once("value",function(t){var e=t.val()||{},n=Object.keys(e).map(function(t){var n=e[t];return n.key=t,n}),a={};n.forEach(function(t){var e=t.playerid;a[e]=t}),console.log(a);var r=n.sort(function(t,e){return 0}).map(function(t){var e=PLAYER_MAP[t.playerid],n=l.getScoreBreakdown(t),a=l.getScorePoints(n),r=l.getScore(a);return{playerid:t.playerid,name:e.name,ward:e.ward,lastMonth:r}}),o=s.getAldersTable({rows:r}),i=document.querySelector("#alders-table");i.innerHTML="",i.appendChild(o),Sortable.initTable(o),Array.from(o.querySelectorAll("button[data-playerid]")).forEach(function(t){t.addEventListener("click",function(e){var n=t.dataset.playerid,r=PLAYER_MAP[n],o=a[n],i=l.getScoreBreakdown(o),c=l.getScorePoints(i),d=l.getScore(c),u=s.getAlderView({playerid:n,profile:r,breakdown:i,points:c,score:d,titles:l.TITLE}),p=vex.dialog.alert({unsafeMessage:u.innerHTML,buttons:[{type:"button",text:"Add To Roster",className:"vex-dialog-button-primary",click:function(t){console.log(t)}},{type:"button",text:"Cancel",className:"vex-dialog-button-secondary",click:function(t){p.close()}}]})})})})},{"./scoring":2,"./views":3}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Scoring=function(){var t=["graffiti","pot_holes","rodent_baiting"],e={absent:-1,contrarian:10,win:1,lose:-1,pass:7,fail:-14,complete:1,incomplete:-1};return{DATASETS_311:t,WEIGHT:e,TITLE:{absent:"Absent",contrarian:"Vote Against Mayor",win:"Won Vote",lose:"Lost Vote",pass:"Passed Bill",fail:"Failed Bill",complete:"Complete 311",incomplete:"Incomplete 311"},getScoreBreakdown:function(e){var n={absent:0,contrarian:0,win:0,lose:0,pass:0,fail:0,complete:0,incomplete:0};return t.forEach(function(t){var a=e["complete_"+t],r=e["incomplete_"+t];n.complete+=a,n.incomplete+=r}),n.absent=e.votes_absent,n.contrarian=e.votes_no_mayor,n.win=e.votes_yes_pass+e.votes_no_fail,n.lose=e.votes_yes_fail+e.votes_no_pass,n.pass=e.sponsor_pass,n.fail=e.sponsor_fail,n},getScorePoints:function(t){var n={};for(var a in t){var r=t[a];n[a]=r*e[a]}return n},getScore:function(t){var e=0;for(var n in t)e+=t[n];return e}}}},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Views=function(){return{getAldersTable:function(t){var e="\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>Name</th>\n\t\t\t\t\t\t<th>Ward</th>\n\t\t\t\t\t\t<th>Score</th>\n\t\t\t\t\t\t<th>View</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t";t.rows.forEach(function(t){e+="\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>"+t.name+"</td>\n\t\t\t\t\t\t<td>"+t.ward+"</td>\n\t\t\t\t\t\t<td>"+t.lastMonth+'</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<button data-playerid="'+t.playerid+'" class="button is-primary is-outlined">View</button>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t'}),e+="\n\t\t\t\t</tbody>\n\t\t\t";var n=document.createElement("table");return n.innerHTML=e,n.classList.add("table"),n.classList.add("sortable-theme-bootstrap"),n.setAttribute("data-sortable",!0),n},getAlderView:function(t){var e='\n\t\t\t\t<div class="media">\n\t\t\t\t\t<div class="media-left">\n\t\t\t\t\t\t<figure class="image is-48x48 headshot-holder">\n\t\t\t\t\t\t\t<img class="headshot-img" src="../public/img/headshots/'+t.playerid+'.png" alt="'+t.profile.name+'">\n\t\t\t\t\t\t</figure>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="media-content">\n\t\t\t\t\t\t<p class="title is-4">'+t.profile.name+'</p>\n\t\t\t\t\t\t<p class="subtitle is-6">Ward '+t.profile.ward+'</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<table class="table is-fullwidth">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Category</th>\n\t\t\t\t\t\t\t<th>Points</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t';for(var n in t.points){var a=t.points[n];e+="\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>"+t.titles[n]+"</td>\n\t\t\t\t\t\t<td>"+(a>0?"+":"")+a+"</td>\n\t\t\t\t\t</tr>\n\t\t\t\t"}e+="\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Total</th>\n\t\t\t\t\t<th>"+t.score+"</th>\n\t\t\t\t</tr>\n\t\t\t",e+="\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t";var r=document.createElement("div");return r.innerHTML=e,r}}}},{}]},{},[1]);
//# sourceMappingURL=maps/main.js.map
